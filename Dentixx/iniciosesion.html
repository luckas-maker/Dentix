<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido a Dentix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
    <style>
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animated-gradient {
            background: linear-gradient(-45deg, #00b4d8, #0077b6, #48cae4, #90e0ef);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: #fff;
            padding: 2rem;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 50px -12px rgba(0, 119, 182, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        @media (max-width: 640px) {
            .modal-content {
                padding: 1.5rem;
                max-height: 85vh;
            }
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .pulse-shadow {
            animation: pulse-shadow 2s ease-in-out infinite;
        }
        
        @keyframes pulse-shadow {
            0%, 100% { box-shadow: 0 10px 40px rgba(0, 180, 216, 0.4); }
            50% { box-shadow: 0 15px 60px rgba(0, 180, 216, 0.6); }
        }

        input:focus {
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }

        .btn-dental {
            background: linear-gradient(135deg, #0077b6 0%, #00b4d8 100%);
            transition: all 0.3s ease;
        }

        .btn-dental:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 119, 182, 0.4);
        }

        .input-modern {
            transition: all 0.3s ease;
        }

        .input-modern:focus {
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.1);
        }

        .tooth-icon {
            font-size: 4rem;
            color: white;
        }

        .dental-accent {
            color: #0077b6;
        }

        .bg-dental-gradient {
            background: linear-gradient(135deg, #00b4d8 0%, #0077b6 100%);
        }
    </style>
</head>
<body class="h-full animated-gradient font-sans">
    <div class="min-h-screen flex items-center justify-center px-4 py-6 sm:py-8 md:py-12">
        <div class="max-w-6xl w-full flex flex-col lg:flex-row rounded-3xl shadow-2xl overflow-hidden">
            <!-- Panel lateral odontológico -->
            <div class="hidden lg:flex lg:w-1/2 bg-gradient-to-br from-cyan-600 via-blue-700 to-sky-500 p-12 flex-col justify-center items-center text-white relative overflow-hidden">
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-0 left-0 w-72 h-72 bg-white rounded-full mix-blend-overlay filter blur-xl animate-pulse"></div>
                    <div class="absolute bottom-0 right-0 w-96 h-96 bg-white rounded-full mix-blend-overlay filter blur-xl animate-pulse delay-1000"></div>
                </div>
                
                <div class="relative z-10 text-center floating-animation">
                    <div class="mb-8">
                        <i class="fas fa-tooth text-8xl mb-6 pulse-shadow"></i>
                    </div>
                    <h2 class="text-4xl font-bold mb-4">Tu Sonrisa Es Nuestra Misión</h2>
                    <p class="text-xl mb-8 opacity-90">Consultorio Dental Dentix</p>
                    <div class="space-y-4 text-left max-w-md mx-auto">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-calendar-check text-2xl"></i>
                            <span>Agenda tu cita en línea</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-user-md text-2xl"></i>
                            <span>Atención profesional especializada</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-2xl"></i>
                            <span>Tecnología y seguridad garantizada</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-smile-beam text-2xl"></i>
                            <span>Resultados que te harán sonreír</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Formulario de login -->
            <div class="w-full lg:w-1/2 glass-effect p-6 sm:p-8 md:p-12">
                <!-- Logo para móvil -->
                <div class="flex justify-center mb-6 lg:hidden">
                    <div class="w-20 h-20 sm:w-24 sm:h-24 bg-dental-gradient rounded-full flex items-center justify-center shadow-xl pulse-shadow">
                        <i class="fas fa-tooth text-white text-3xl sm:text-4xl"></i>
                    </div>
                </div>
                
                <!-- Logo para desktop -->
                <div class="hidden lg:flex justify-center mb-8">
                    <div class="w-28 h-28 bg-dental-gradient rounded-full flex items-center justify-center shadow-xl pulse-shadow">
                        <i class="fas fa-tooth text-white text-5xl"></i>
                    </div>
                </div>
                
                <!-- Título -->
                <div class="text-center mb-6 sm:mb-8">
                    <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-700 bg-clip-text text-transparent mb-2">
                        Consultorio Dental "Dentix"
                    </h1>
                    <p class="text-sm sm:text-base text-gray-600">
                        <i class="fas fa-tooth dental-accent mr-1"></i>
                        Cuidando de tu sonrisa, siempre
                    </p>
                </div>

                <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 text-center mb-6 sm:mb-8">Acceso al Sistema</h2>
                
                <!-- Formulario -->
                <form id="login-form" class="space-y-5 sm:space-y-6" onsubmit="return validarLogin(event)">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-envelope dental-accent mr-2"></i>
                            Correo Electrónico
                        </label>
                        <input type="email" id="email" required 
                            class="input-modern w-full px-4 py-3 sm:py-4 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all text-sm sm:text-base"
                            placeholder="tu@email.com">
                        <div id="email-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                            <i class="fas fa-exclamation-circle mr-1"></i>
                            Por favor ingresa un correo electrónico válido.
                        </div>
                    </div>
                    
                    <div class="relative">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-lock dental-accent mr-2"></i>
                            Contraseña
                        </label>
                        <input type="password" id="password" required 
                            class="input-modern w-full px-4 py-3 sm:py-4 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all pr-12 text-sm sm:text-base"
                            placeholder="••••••••">
                        <i id="toggle-password" class="fas fa-eye absolute right-4 top-11 sm:top-12 cursor-pointer text-gray-500 hover:text-cyan-600 transition-colors" onclick="togglePassword()"></i>
                        <div id="password-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                            <i class="fas fa-exclamation-circle mr-1"></i>
                            La contraseña es obligatoria.
                        </div>
                    </div>
                    
                    <button type="submit" 
                        class="btn-dental w-full py-3 sm:py-4 px-4 text-white font-bold rounded-xl shadow-lg text-sm sm:text-base">
                        <i class="fas fa-sign-in-alt mr-2"></i>
                        Iniciar Sesión
                    </button>
                </form>
                
                <!-- Alerta -->
                <div id="alert" class="hidden mt-4 text-center p-3 rounded-xl"></div>
                
                <!-- Enlaces -->
                <div class="text-center mt-6">
                    <button onclick="mostrarRecuperacion()" class="text-sm sm:text-base font-semibold dental-accent hover:text-blue-800 transition-colors inline-flex items-center">
                        <i class="fas fa-key mr-2"></i>
                        ¿Olvidaste tu contraseña?
                    </button>
                </div>
                
                <div class="text-center mt-6 pt-6 border-t-2 border-gray-200">
                    <p class="text-sm sm:text-base text-gray-600">
                        ¿Primera vez en Dentix? 
                        <button onclick="mostrarRegistro()" 
                            class="font-bold dental-accent hover:text-blue-800 transition-colors">
                            Regístrate aquí
                        </button>
                    </p>
                </div>

                <!-- Info adicional -->
                <div class="text-center mt-6 pt-6 border-t-2 border-gray-200">
                    <p class="text-xs text-gray-500">
                        <i class="fas fa-shield-alt mr-1"></i>
                        Tus datos están protegidos y seguros
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de registro -->
    <div id="registro-modal" class="modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-700 bg-clip-text text-transparent">
                    <i class="fas fa-user-plus mr-2"></i>
                    Nuevo Paciente
                </h2>
                <button onclick="ocultarRegistro()" class="text-gray-400 hover:text-gray-600 text-2xl transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="registro-formulario" class="space-y-4" onsubmit="return validarRegistro(event)">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-user dental-accent mr-2"></i>
                        Nombre Completo
                    </label>
                    <input type="text" id="nombre" required 
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                        placeholder="Ej: Juan Pérez García">
                    <div id="nombre-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Por favor ingresa solo letras.
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-envelope dental-accent mr-2"></i>
                        Correo Electrónico
                    </label>
                    <input type="email" id="registro-email" required 
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                        placeholder="tu@email.com">
                    <div id="registro-email-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Por favor ingresa un correo electrónico válido.
                    </div>
                    <div id="email-existente-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Este correo ya está registrado.
                    </div>
                </div>
                
                <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    <i class="fas fa-phone-alt dental-accent mr-2"></i>
                    Teléfono (10 dígitos)
                </label>
                <input type="tel" id="registro-telefono" name="telefono" required 
                    pattern="[0-9]{10}" 
                    maxlength="10"
                    class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                    placeholder="7541234567">
                    
                <div id="registro-telefono-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                    <i class="fas fa-exclamation-circle mr-1"></i>
                    Ingresa un número de teléfono válido de 10 dígitos.
                </div>
                
                <div id="telefono-existente-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                    <i class="fas fa-exclamation-circle mr-1"></i>
                    Este número ya ha sido registrado.
                </div>
                </div>


                <div class="relative">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-lock dental-accent mr-2"></i>
                        Contraseña
                    </label>
                    <input type="password" id="registro-password" required 
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 pr-12"
                        placeholder="Mínimo 6 caracteres">
                    <i id="toggle-registro-password" class="fas fa-eye absolute right-4 top-11 cursor-pointer text-gray-500 hover:text-cyan-600 transition-colors" onclick="togglePasswordRegistro()"></i>
                    <div id="registro-password-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        La contraseña debe tener más de 6 caracteres.
                    </div>
                </div>
                
                <div class="relative">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-lock dental-accent mr-2"></i>
                        Confirmar Contraseña
                    </label>
                    <input type="password" id="confirmar-password" required 
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 pr-12"
                        placeholder="Repite tu contraseña">
                    <i id="toggle-confirmar-password" class="fas fa-eye absolute right-4 top-11 cursor-pointer text-gray-500 hover:text-cyan-600 transition-colors" onclick="toggleConfirmarPassword()"></i>
                    <div id="confirmar-password-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Las contraseñas no coinciden.
                    </div>
                </div>
                
                <button type="submit" 
                    class="btn-dental w-full py-3 px-4 text-white font-bold rounded-xl shadow-lg">
                    <i class="fas fa-user-check mr-2"></i>
                    Registrarme
                </button>
            </form>
            
            <div class="text-center mt-6">
                <button onclick="ocultarRegistro()" class="text-sm font-semibold dental-accent hover:text-blue-800 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Ya tengo cuenta
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de recuperación de contraseña -->
    <div id="recuperacion-modal" class="modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-700 bg-clip-text text-transparent">
                    <i class="fas fa-key mr-2"></i>
                    Recuperar Acceso
                </h2>
                <button onclick="ocultarRecuperacion()" class="text-gray-400 hover:text-gray-600 text-2xl transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <p class="text-gray-600 mb-6 text-sm sm:text-base">Ingresa tu correo electrónico y te enviaremos un código de verificación.</p>
            
            <form id="recuperacion-formulario" class="space-y-4" onsubmit="return enviarCodigoRecuperacion(event)">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-envelope dental-accent mr-2"></i>
                        Correo Electrónico
                    </label>
                    <input type="email" id="recuperacion-email" required
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                        placeholder="tu@email.com">
                    <div id="recuperacion-email-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Ingresa un correo válido.
                    </div>
                </div>
                
                <button type="submit" 
                    class="btn-dental w-full py-3 px-4 text-white font-bold rounded-xl shadow-lg">
                    <i class="fas fa-paper-plane mr-2"></i>
                    Enviar Código
                </button>
            </form>
            
            <div class="text-center mt-6">
                <button onclick="ocultarRecuperacion()" class="text-sm font-semibold dental-accent hover:text-blue-800 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de verificación de código -->
    <div id="verificar-modal" class="modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-700 bg-clip-text text-transparent">
                    <i class="fas fa-shield-alt mr-2"></i>
                    Código de Seguridad
                </h2>
                <button onclick="ocultarVerificacion()" class="text-gray-400 hover:text-gray-600 text-2xl transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <p class="text-gray-600 mb-6 text-sm sm:text-base">Ingresa el código de 6 dígitos que enviamos a tu correo.</p>
            
            <form id="verificar-formulario" class="space-y-4" onsubmit="return verificarCodigo(event)">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2 text-center">Código de Verificación</label>
                    <input type="text" id="codigo" required maxlength="6"
                        class="input-modern w-full px-4 py-4 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-center text-2xl tracking-widest font-bold"
                        placeholder="000000">
                    <div id="codigo-error" class="hidden text-sm text-red-600 mt-2 flex items-center justify-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Ingresa el código.
                    </div>
                </div>
                
                <button type="submit" 
                    class="btn-dental w-full py-3 px-4 text-white font-bold rounded-xl shadow-lg">
                    <i class="fas fa-check-circle mr-2"></i>
                    Verificar Código
                </button>
            </form>
            
            <div class="text-center mt-6">
                <button onclick="ocultarVerificacion()" class="text-sm font-semibold dental-accent hover:text-blue-800 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de cambio de contraseña -->
    <div id="cambiar-modal" class="modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-700 bg-clip-text text-transparent">
                    <i class="fas fa-lock mr-2"></i>
                    Nueva Contraseña
                </h2>
                <button onclick="ocultarCambio()" class="text-gray-400 hover:text-gray-600 text-2xl transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <p class="text-gray-600 mb-6 text-sm sm:text-base">Crea una nueva contraseña segura para tu cuenta.</p>
            
            <form id="cambiar-formulario" class="space-y-4" onsubmit="return cambiarContrasena(event)">
                <div class="relative">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-lock dental-accent mr-2"></i>
                        Nueva Contraseña
                    </label>
                    <input type="password" id="nueva-contrasena" required
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 pr-12"
                        placeholder="Mínimo 6 caracteres">
                    <i id="toggle-nueva-password" class="fas fa-eye absolute right-4 top-11 cursor-pointer text-gray-500 hover:text-cyan-600 transition-colors" onclick="toggleNuevaPassword()"></i>
                    <div id="nueva-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Debe tener más de 6 caracteres.
                    </div>
                </div>
                
                <div class="relative">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-lock dental-accent mr-2"></i>
                        Confirmar Contraseña
                    </label>
                    <input type="password" id="confirmar-nueva" required
                        class="input-modern w-full px-4 py-3 border-2 border-gray-200 rounded-xl shadow-sm focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 pr-12"
                        placeholder="Repite tu contraseña">
                    <i id="toggle-confirmar-nueva-password" class="fas fa-eye absolute right-4 top-11 cursor-pointer text-gray-500 hover:text-cyan-600 transition-colors" onclick="toggleConfirmarNuevaPassword()"></i>
                    <div id="confirmar-error" class="hidden text-sm text-red-600 mt-2 flex items-center">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        Las contraseñas no coinciden.
                    </div>
                </div>
                
                <button type="submit" 
                    class="btn-dental w-full py-3 px-4 text-white font-bold rounded-xl shadow-lg">
                    <i class="fas fa-save mr-2"></i>
                    Cambiar Contraseña
                </button>
            </form>
            
            <div class="text-center mt-6">
                <button onclick="ocultarCambio()" class="text-sm font-semibold dental-accent hover:text-blue-800 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script>
        let emailRecuperacion = "";
        let users = {};

        function mostrarRecuperacion() {
            document.getElementById("recuperacion-modal").style.display = "flex";
        }
        
        function ocultarRecuperacion() {
            document.getElementById("recuperacion-modal").style.display = "none";
        }
        
        function enviarCodigoRecuperacion(event) {
            event.preventDefault();
            const email = document.getElementById("recuperacion-email").value;
            
            if (!email) {
                document.getElementById("recuperacion-email-error").classList.remove("hidden");
                return false;
            }
            
            document.getElementById("recuperacion-email-error").classList.add("hidden");
            emailRecuperacion = email;
            mostrarAlerta("success", "Código de verificación enviado a tu correo.");
            ocultarRecuperacion();
            mostrarVerificacion();
            return false;
        }

        function mostrarVerificacion() {
            document.getElementById("verificar-modal").style.display = "flex";
        }
        
        function ocultarVerificacion() {
            document.getElementById("verificar-modal").style.display = "none";
        }
        
        function verificarCodigo(event) {
            event.preventDefault();
            const codigo = document.getElementById("codigo").value;
            
            if (!codigo) {
                document.getElementById("codigo-error").classList.remove("hidden");
                return false;
            }
            
            document.getElementById("codigo-error").classList.add("hidden");
            mostrarAlerta("success", "Código verificado correctamente.");
            ocultarVerificacion();
            mostrarCambio();
            return false;
        }

        function mostrarCambio() {
            document.getElementById("cambiar-modal").style.display = "flex";
        }
        
        function ocultarCambio() {
            document.getElementById("cambiar-modal").style.display = "none";
        }
        
        function cambiarContrasena(event) {
            event.preventDefault();
            const nueva = document.getElementById("nueva-contrasena").value;
            const confirmar = document.getElementById("confirmar-nueva").value;
            let valido = true;
            
            if (nueva.length < 6) {
                document.getElementById("nueva-error").classList.remove("hidden");
                valido = false;
            } else {
                document.getElementById("nueva-error").classList.add("hidden");
            }
            
            if (nueva !== confirmar) {
                document.getElementById("confirmar-error").classList.remove("hidden");
                valido = false;
            } else {
                document.getElementById("confirmar-error").classList.add("hidden");
            }
            
            if (!valido) return false;
            
            users[emailRecuperacion].password = nueva;
            mostrarAlerta("success", "Contraseña cambiada exitosamente.");
            ocultarCambio();
            return false;
        }

        function mostrarRegistro() {
            document.getElementById("registro-modal").style.display = "flex";
        }

        function ocultarRegistro() {
            document.getElementById("registro-modal").style.display = "none";
        }

        function validarRegistro(event) {
            event.preventDefault();    
            const nombre = document.getElementById("nombre").value;
            const email = document.getElementById("registro-email").value;
            const password = document.getElementById("registro-password").value;
            const confirmarPassword = document.getElementById("confirmar-password").value;

            let valid = true;

            const regexNombre = /^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/;
            if (!regexNombre.test(nombre)) {
                document.getElementById("nombre-error").classList.remove("hidden");
                valid = false;
            } else {
                document.getElementById("nombre-error").classList.add("hidden");
            }

            const regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!regexEmail.test(email)) {
                document.getElementById("registro-email-error").classList.remove("hidden");
                valid = false;
            } else {
                document.getElementById("registro-email-error").classList.add("hidden");
            }

            if (users[email]) {
                document.getElementById("email-existente-error").classList.remove("hidden");
                valid = false;
            } else {
                document.getElementById("email-existente-error").classList.add("hidden");
            }

            if (password.length < 6) {
                document.getElementById("registro-password-error").classList.remove("hidden");
                valid = false;
            } else {
                document.getElementById("registro-password-error").classList.add("hidden");
            }

            if (password !== confirmarPassword) {
                document.getElementById("confirmar-password-error").classList.remove("hidden");
                valid = false;
            } else {
                document.getElementById("confirmar-password-error").classList.add("hidden");
            }

            if (valid) {
                users[email] = { nombre, password, tipo: 'Paciente' };
                mostrarAlerta("success", "Registro exitoso. Ya puedes iniciar sesión.");
                ocultarRegistro();
            }
            
            return false;
        }

        function validarLogin(event) {
            event.preventDefault();
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            if (!email || !password) {
                if (!email) {
                    document.getElementById("email-error").classList.remove("hidden");
                } else {
                    document.getElementById("email-error").classList.add("hidden");
                }
                if (!password) {
                    document.getElementById("password-error").classList.remove("hidden");
                } else {
                    document.getElementById("password-error").classList.add("hidden");
                }
                return false;
            }

            document.getElementById("email-error").classList.add("hidden");
            document.getElementById("password-error").classList.add("hidden");

            if (users[email] && users[email].password === password) {
                mostrarAlerta("success", "Inicio de sesión exitoso.");
                setTimeout(() => {
                    alert(`Bienvenido ${users[email].nombre}\nTipo de usuario: ${users[email].tipo}`);
                }, 1500);
            } else {
                mostrarAlerta("error", "Correo o contraseña incorrectos.");
            }
            
            return false;
        }

        function togglePassword() {
            const passwordField = document.getElementById("password");
            const icon = document.getElementById("toggle-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        }

        function togglePasswordRegistro() {
            const passwordField = document.getElementById("registro-password");
            const icon = document.getElementById("toggle-registro-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        }

        function toggleConfirmarPassword() {
            const passwordField = document.getElementById("confirmar-password");
            const icon = document.getElementById("toggle-confirmar-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        }

        function toggleNuevaPassword() {
            const passwordField = document.getElementById("nueva-contrasena");
            const icon = document.getElementById("toggle-nueva-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        }

        function toggleConfirmarNuevaPassword() {
            const passwordField = document.getElementById("confirmar-nueva");
            const icon = document.getElementById("toggle-confirmar-nueva-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        }

        function mostrarAlerta(tipo, mensaje) {
            const alertDiv = document.getElementById("alert");
            alertDiv.className = "mt-4 p-4 rounded-xl text-center font-semibold shadow-lg flex items-center justify-center";
            
            if (tipo === "error") {
                alertDiv.classList.add("bg-red-100", "text-red-700", "border-2", "border-red-300");
                alertDiv.innerHTML = `<i class="fas fa-exclamation-circle mr-2"></i>${mensaje}`;
            } else {
                alertDiv.classList.add("bg-green-100", "text-green-700", "border-2", "border-green-300");
                alertDiv.innerHTML = `<i class="fas fa-check-circle mr-2"></i>${mensaje}`;
            }
            
            alertDiv.classList.remove("hidden");
            
            setTimeout(() => {
                alertDiv.classList.add("hidden");
            }, 3000);
        }
    </script>
</body>
</html>