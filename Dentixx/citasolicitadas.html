<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Solicitudes de Citas - Cl√≠nica Dental</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
    </style>
</head>
<body class="h-full bg-gradient-to-br from-blue-50 to-indigo-100 font-sans">
    <div class="min-h-full">
        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Header Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300 mb-8">
                <div class="flex items-center">
                    <div class="text-3xl mr-4">ü¶∑</div>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">Solicitudes de Citas Pendientes</h1>
                        <p class="text-gray-600">Revisa y gestiona las nuevas solicitudes de citas de tus pacientes</p>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center">
                        <div class="text-3xl mr-4">‚è≥</div>
                        <div>
                            <p class="text-sm font-medium text-gray-600">Pendientes</p>
                            <p class="text-2xl font-bold text-orange-600" id="pendingCount">5</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center">
                        <div class="text-3xl mr-4">‚úÖ</div>
                        <div>
                            <p class="text-sm font-medium text-gray-600">Aceptadas Hoy</p>
                            <p class="text-2xl font-bold text-green-600" id="acceptedCount">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center">
                        <div class="text-3xl mr-4">‚ùå</div>
                        <div>
                            <p class="text-sm font-medium text-gray-600">Rechazadas Hoy</p>
                            <p class="text-2xl font-bold text-red-600" id="rejectedCount">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Appointments List -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">Solicitudes Recientes</h3>
                </div>
                <div class="divide-y divide-gray-200" id="appointmentsList">
                    <!-- Appointment items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Empty State (hidden by default) -->
            <div id="emptyState" class="hidden text-center py-12">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">¬°Todas las solicitudes procesadas!</h3>
                <p class="text-gray-600">No hay solicitudes pendientes en este momento.</p>
            </div>
        </main>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl">
            <div class="text-center">
                <div id="modalIcon" class="text-4xl mb-4"></div>
                <h3 id="modalTitle" class="text-lg font-semibold text-gray-900 mb-2"></h3>
                <p id="modalMessage" class="text-gray-600 mb-6"></p>
                <div class="flex space-x-3">
                    <button id="cancelBtn" class="flex-1 px-4 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancelar
                    </button>
                    <button id="confirmBtn" class="flex-1 px-4 py-2 rounded-xl text-white font-medium transition-colors">
                        Confirmar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample appointment data
        let appointments = [
            {
                id: 1,
                patientName: "Mar√≠a Gonz√°lez",
                phone: "+34 612 345 678",
                email: "maria.gonzalez@email.com",
                service: "Limpieza dental",
                preferredDate: "2024-01-15",
                preferredTime: "10:00",
                notes: "Primera visita, necesita revisi√≥n general",
                requestDate: "2024-01-10",
                status: "pending"
            },
            {
                id: 2,
                patientName: "Carlos Rodr√≠guez",
                phone: "+34 687 654 321",
                email: "carlos.rodriguez@email.com",
                service: "Empaste",
                preferredDate: "2024-01-16",
                preferredTime: "15:30",
                notes: "Dolor en muela superior derecha",
                requestDate: "2024-01-11",
                status: "pending"
            },
            {
                id: 3,
                patientName: "Ana Mart√≠n",
                phone: "+34 654 987 123",
                email: "ana.martin@email.com",
                service: "Ortodoncia - Consulta",
                preferredDate: "2024-01-17",
                preferredTime: "09:00",
                notes: "Interesada en brackets invisibles",
                requestDate: "2024-01-11",
                status: "pending"
            },
            {
                id: 4,
                patientName: "Luis Fern√°ndez",
                phone: "+34 698 741 852",
                email: "luis.fernandez@email.com",
                service: "Extracci√≥n",
                preferredDate: "2024-01-18",
                preferredTime: "11:00",
                notes: "Muela del juicio problem√°tica",
                requestDate: "2024-01-12",
                status: "pending"
            },
            {
                id: 5,
                patientName: "Carmen L√≥pez",
                phone: "+34 645 123 789",
                email: "carmen.lopez@email.com",
                service: "Blanqueamiento",
                preferredDate: "2024-01-19",
                preferredTime: "16:00",
                notes: "Consulta sobre opciones de blanqueamiento",
                requestDate: "2024-01-12",
                status: "pending"
            }
        ];

        let currentAction = null;
        let currentAppointmentId = null;

        function renderAppointments() {
            const container = document.getElementById('appointmentsList');
            const emptyState = document.getElementById('emptyState');
            const pendingAppointments = appointments.filter(apt => apt.status === 'pending');

            if (pendingAppointments.length === 0) {
                container.parentElement.style.display = 'none';
                emptyState.classList.remove('hidden');
                return;
            }

            container.innerHTML = '';
            emptyState.classList.add('hidden');
            container.parentElement.style.display = 'block';

            pendingAppointments.forEach(appointment => {
                const appointmentElement = document.createElement('div');
                appointmentElement.className = 'p-6 hover:bg-gray-50 transition-colors';
                appointmentElement.innerHTML = `
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
                        <div class="flex-1">
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0">
                                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600 font-semibold text-lg">${appointment.patientName.charAt(0)}</span>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-2">
                                        <h4 class="text-lg font-semibold text-gray-900">${appointment.patientName}</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                                            Pendiente
                                        </span>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-gray-600 mb-3">
                                        <div class="flex items-center">
                                            <span class="mr-2">üìû</span>
                                            ${appointment.phone}
                                        </div>
                                        <div class="flex items-center">
                                            <span class="mr-2">üìß</span>
                                            ${appointment.email}
                                        </div>
                                        <div class="flex items-center">
                                            <span class="mr-2">ü¶∑</span>
                                            ${appointment.service}
                                        </div>
                                        <div class="flex items-center">
                                            <span class="mr-2">üìÖ</span>
                                            ${formatDate(appointment.preferredDate)} a las ${appointment.preferredTime}
                                        </div>
                                    </div>
                                    ${appointment.notes ? `
                                        <div class="bg-gray-50 rounded-xl p-3 mb-3 border border-gray-200">
                                            <p class="text-sm text-gray-700"><strong>Notas:</strong> ${appointment.notes}</p>
                                        </div>
                                    ` : ''}
                                    <p class="text-xs text-gray-500">Solicitada el ${formatDate(appointment.requestDate)}</p>
                                </div>
                            </div>
                        </div>
                        <div class="flex space-x-3 lg:ml-6">
                            <button onclick="showConfirmation('accept', ${appointment.id})" 
                                    class="flex-1 lg:flex-none bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-xl font-medium transition-all duration-200 flex items-center justify-center shadow-md hover:shadow-lg">
                                <span class="mr-2">‚úÖ</span>
                                Aceptar
                            </button>
                            <button onclick="showConfirmation('reject', ${appointment.id})" 
                                    class="flex-1 lg:flex-none bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-xl font-medium transition-all duration-200 flex items-center justify-center shadow-md hover:shadow-lg">
                                <span class="mr-2">‚ùå</span>
                                Rechazar
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(appointmentElement);
            });
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function updateStats() {
            const pending = appointments.filter(apt => apt.status === 'pending').length;
            const accepted = appointments.filter(apt => apt.status === 'accepted').length;
            const rejected = appointments.filter(apt => apt.status === 'rejected').length;

            document.getElementById('pendingCount').textContent = pending;
            document.getElementById('acceptedCount').textContent = accepted;
            document.getElementById('rejectedCount').textContent = rejected;
        }

        function showConfirmation(action, appointmentId) {
            currentAction = action;
            currentAppointmentId = appointmentId;
            
            const appointment = appointments.find(apt => apt.id === appointmentId);
            const modal = document.getElementById('confirmModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const confirmBtn = document.getElementById('confirmBtn');

            if (action === 'accept') {
                modalIcon.textContent = '‚úÖ';
                modalTitle.textContent = 'Aceptar Cita';
                modalMessage.textContent = `¬øConfirmas que quieres aceptar la cita de ${appointment.patientName} para ${appointment.service}?`;
                confirmBtn.className = 'flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-white font-medium transition-colors';
                confirmBtn.textContent = 'Aceptar Cita';
            } else {
                modalIcon.textContent = '‚ùå';
                modalTitle.textContent = 'Rechazar Cita';
                modalMessage.textContent = `¬øEst√°s seguro de que quieres rechazar la cita de ${appointment.patientName}?`;
                confirmBtn.className = 'flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white font-medium transition-colors';
                confirmBtn.textContent = 'Rechazar Cita';
            }

            modal.classList.remove('hidden');
        }

        function hideConfirmation() {
            document.getElementById('confirmModal').classList.add('hidden');
            currentAction = null;
            currentAppointmentId = null;
        }

        function processAppointment() {
            if (currentAction && currentAppointmentId) {
                const appointmentIndex = appointments.findIndex(apt => apt.id === currentAppointmentId);
                if (appointmentIndex !== -1) {
                    appointments[appointmentIndex].status = currentAction === 'accept' ? 'accepted' : 'rejected';
                    renderAppointments();
                    updateStats();
                    
                    // Show success message
                    const action = currentAction === 'accept' ? 'aceptada' : 'rechazada';
                    showSuccessMessage(`Cita ${action} correctamente`);
                }
            }
            hideConfirmation();
        }

        function showSuccessMessage(message) {
            // Create temporary success message
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            successDiv.textContent = message;
            document.body.appendChild(successDiv);

            // Animate in
            setTimeout(() => {
                successDiv.classList.remove('translate-x-full');
            }, 100);

            // Remove after 3 seconds
            setTimeout(() => {
                successDiv.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
        }

        // Event listeners
        document.getElementById('cancelBtn').addEventListener('click', hideConfirmation);
        document.getElementById('confirmBtn').addEventListener('click', processAppointment);

        // Close modal when clicking outside
        document.getElementById('confirmModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideConfirmation();
            }
        });

        // Initialize
        renderAppointments();
        updateStats();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9915c38e475e55c3',t:'MTc2MDkzNDQ1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
