<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Citas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .appointment-card {
            transition: all 0.2s ease;
        }
        .appointment-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="h-full bg-gradient-to-br from-blue-50 to-indigo-100 font-sans">
    <div class="min-h-full p-6">
        <!-- Header -->
        <div class="max-w-7xl mx-auto mb-8">
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-blue-100">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Mis Citas</h1>
                        <p class="text-gray-600">Visualice todas sus citas reservadas</p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500">Fecha actual</div>
                        <div class="text-lg font-semibold text-blue-600" id="currentDate"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto">
            <!-- Search and Appointments List -->
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-blue-100">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">üìã Lista de Citas Reservadas</h2>
                    <div class="flex items-center space-x-4">
                        <label for="searchDate" class="text-sm text-gray-600">Buscar por fecha:</label>
                        <input type="date" id="searchDate" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button onclick="filterAppointments()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">Buscar</button>
                        <button onclick="clearSearch()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">Limpiar</button>
                    </div>
                </div>
                <div id="appointmentsList" class="space-y-4">
                    <!-- Appointments will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample reserved appointments data - dynamic dates
        let reservedAppointments = [];

        function formatDate(date) {
            return date.getFullYear() + '-' + String(date.getMonth() + 1).padStart(2, '0') + '-' + String(date.getDate()).padStart(2, '0');
        }

        function generateSampleAppointments() {
            const today = new Date();
            const sampleAppointments = [
                {
                    id: 1,
                    date: formatDate(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 1)),
                    time: '09:00',
                    service: 'Limpieza dental',
                    status: 'Reservada'
                },
                {
                    id: 2,
                    date: formatDate(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 5)),
                    time: '14:00',
                    service: 'Endodoncia',
                    status: 'Reservada'
                },
                {
                    id: 3,
                    date: formatDate(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 10)),
                    time: '16:00',
                    service: 'Ortodoncia',
                    status: 'Reservada'
                },
                {
                    id: 4,
                    date: formatDate(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 15)),
                    time: '09:30',
                    service: 'Implante dental',
                    status: 'Reservada'
                },
                {
                    id: 5,
                    date: formatDate(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 20)),
                    time: '13:00',
                    service: 'Blanqueamiento',
                    status: 'Reservada'
                }
            ];
            reservedAppointments = sampleAppointments;
        }

        // Initialize the page
        function initPage() {
            generateSampleAppointments();
            updateCurrentDate();
            sortAppointments();
            generateAppointmentsList();
        }

        function updateCurrentDate() {
            const today = new Date();
            const currentDateElement = document.getElementById('currentDate');
            const dateText = document.createTextNode(today.toLocaleDateString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }));
            currentDateElement.appendChild(dateText);
        }

        function sortAppointments() {
            reservedAppointments.sort((a, b) => new Date(a.date) - new Date(b.date)); // Ascendente: m√°s antigua primero
        }

        function filterAppointments() {
            const searchDate = document.getElementById('searchDate').value;
            generateAppointmentsList(searchDate);
        }

        function clearSearch() {
            document.getElementById('searchDate').value = '';
            generateAppointmentsList();
        }

        function cancelAppointment(id) {
            if (confirm('¬øEst√°s seguro de que quieres cancelar la cita?')) {
                const appointment = reservedAppointments.find(app => app.id === id);
                if (appointment) {
                    appointment.status = 'Cancelada';
                    alert('La cita ha sido cancelada exitosamente.');
                    generateAppointmentsList(document.getElementById('searchDate').value); // Regenerar la lista manteniendo el filtro actual
                }
            }
        }

        function generateAppointmentsList(filterDate = '') {
            const appointmentsList = document.getElementById('appointmentsList');
            // Clear existing content
            while (appointmentsList.firstChild) {
                appointmentsList.removeChild(appointmentsList.firstChild);
            }

            let filteredAppointments = reservedAppointments;
            if (filterDate) {
                filteredAppointments = reservedAppointments.filter(appointment => appointment.date === filterDate);
            }

            if (filteredAppointments.length === 0) {
                const noAppointments = document.createElement('div');
                noAppointments.className = 'text-center text-gray-500 py-8';
                const noText = document.createTextNode(filterDate ? 'No hay citas para la fecha seleccionada' : 'No tiene citas reservadas');
                noAppointments.appendChild(noText);
                appointmentsList.appendChild(noAppointments);
                return;
            }

            filteredAppointments.forEach(appointment => {
                const appointmentCard = document.createElement('div');
                appointmentCard.className = 'appointment-card bg-blue-50 rounded-lg p-4 border border-blue-200';

                const dateObj = new Date(appointment.date);
                const dateFormatted = dateObj.toLocaleDateString('es-ES', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });

                const dateDiv = document.createElement('div');
                dateDiv.className = 'flex items-center space-x-2 mb-2';
                const dateLabel = document.createElement('span');
                dateLabel.className = 'text-sm text-gray-600';
                const dateLabelText = document.createTextNode('üìÖ Fecha:');
                dateLabel.appendChild(dateLabelText);
                const dateValue = document.createElement('span');
                dateValue.className = 'font-semibold text-gray-800';
                const dateValueText = document.createTextNode(dateFormatted);
                dateValue.appendChild(dateValueText);
                dateDiv.appendChild(dateLabel);
                dateDiv.appendChild(dateValue);

                const timeDiv = document.createElement('div');
                timeDiv.className = 'flex items-center space-x-2 mb-2';
                const timeLabel = document.createElement('span');
                timeLabel.className = 'text-sm text-gray-600';
                const timeLabelText = document.createTextNode('üïê Hora:');
                timeLabel.appendChild(timeLabelText);
                const timeValue = document.createElement('span');
                timeValue.className = 'font-bold text-lg text-gray-800';
                const timeValueText = document.createTextNode(appointment.time);
                timeValue.appendChild(timeValueText);
                timeDiv.appendChild(timeLabel);
                timeDiv.appendChild(timeValue);

                const serviceDiv = document.createElement('div');
                serviceDiv.className = 'flex items-center space-x-2 mb-2';
                const serviceLabel = document.createElement('span');
                serviceLabel.className = 'text-sm text-gray-600';
                const serviceLabelText = document.createTextNode('ü¶∑ Tipo de cita:');
                serviceLabel.appendChild(serviceLabelText);
                const serviceValue = document.createElement('span');
                serviceValue.className = 'text-gray-800';
                const serviceValueText = document.createTextNode(appointment.service);
                serviceValue.appendChild(serviceValueText);
                serviceDiv.appendChild(serviceLabel);
                serviceDiv.appendChild(serviceValue);

                const statusDiv = document.createElement('div');
                statusDiv.className = 'flex items-center space-x-2 mb-2';
                const statusLabel = document.createElement('span');
                statusLabel.className = 'text-sm text-gray-600';
                const statusLabelText = document.createTextNode('üìã Estado:');
                statusLabel.appendChild(statusLabelText);
                const statusValue = document.createElement('span');
                statusValue.className = appointment.status === 'Reservada' ? 'font-semibold text-green-600' : 'font-semibold text-red-600';
                const statusValueText = document.createTextNode(appointment.status);
                statusValue.appendChild(statusValueText);
                statusDiv.appendChild(statusLabel);
                statusDiv.appendChild(statusValue);

                const buttonDiv = document.createElement('div');
                buttonDiv.className = 'flex justify-end';
                if (appointment.status === 'Reservada') {
                    const cancelButton = document.createElement('button');
                    cancelButton.className = 'px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors';
                    cancelButton.textContent = 'Cancelar';
                    cancelButton.onclick = () => cancelAppointment(appointment.id);
                    buttonDiv.appendChild(cancelButton);
                }

                appointmentCard.appendChild(dateDiv);
                appointmentCard.appendChild(timeDiv);
                appointmentCard.appendChild(serviceDiv);
                appointmentCard.appendChild(statusDiv);
                appointmentCard.appendChild(buttonDiv);

                appointmentsList.appendChild(appointmentCard);
            });
        }

        // Initialize the application
        initPage();
    </script>
</body>
</html>